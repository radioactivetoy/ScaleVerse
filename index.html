<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScaleVerse</title>
    <link rel="stylesheet" href="static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <div class="header-tools">
            <button id="drone-btn" class="tool-btn">Drone üîá</button>
            <button id="settings-btn" class="tool-btn">Settings ‚öôÔ∏è</button>
            <button id="save-btn" class="tool-btn">Save Image üì∏</button>
            <button id="explorer-btn" class="tool-btn">Progression üï∏Ô∏è</button>

            <div id="settings-panel" class="settings-panel hidden">
                <h3>Configuration</h3>
                <div class="control-group">
                    <label for="instrument-select">Instrument</label>
                    <select id="instrument-select">
                        <!-- Populated by JS -->
                    </select>
                </div>
                <div class="control-group">
                    <label for="tuning-select">Tuning</label>
                    <select id="tuning-select">
                        <option value="Standard">Standard (E A D G B E)</option>
                        <option value="Drop D">Drop D (D A D G B E)</option>
                        <option value="Double Drop D">Double Drop D (D A D G B D)</option>
                        <option value="DADGAD">DADGAD</option>
                        <option value="Open D">Open D (D A D F# A D)</option>
                        <option value="Open G">Open G (D G D G B D)</option>
                        <option value="Open E">Open E (E B E G# B E)</option>
                        <option value="Eb Standard">Eb Standard (Half-Step Down)</option>
                        <option value="D Standard">D Standard (Whole-Step Down)</option>
                        <option value="7 String Standard">7 String (B Standard)</option>
                        <option value="8 String Standard">8 String (F# Standard)</option>
                        <optgroup label="Extended Range">
                            <option value="7 String Standard">7 String (B Standard)</option>
                            <option value="8 String Standard">8 String (F# Standard)</option>
                        </optgroup>
                    </select>
                </div>
            </div>
        </div>
        <header>
            <h1>Scale<span class="highlight">Verse</span></h1>
            <p>Interactive Scale Visualization</p>
        </header>

        <div class="controls">
            <div class="control-group">
                <label for="root-select">Root Note</label>
                <select id="root-select">
                    <!-- Options populated by JS -->
                </select>
            </div>



            <div class="control-group">
                <label for="scale-select">Scale Type</label>
                <select id="scale-select">
                    <option value="Major">Major (Ionian)</option>
                    <option value="Minor">Minor (Aeolian)</option>
                    <option value="Dorian">Dorian</option>
                    <option value="Phrygian">Phrygian</option>
                    <option value="Lydian">Lydian</option>
                    <option value="Mixolydian">Mixolydian</option>
                    <option value="Locrian">Locrian</option>
                    <optgroup label="Pentatonic Scales">
                        <option value="major_pentatonic">Major Pentatonic</option>
                        <option value="minor_pentatonic">Minor Pentatonic</option>
                        <option value="blues_minor">Blues Scale (Minor Blues)</option>
                    </optgroup>
                    <optgroup label="Harmonic Minor Modes">
                        <option value="harmonic_minor">Harmonic Minor</option>
                        <option value="locrian_6">Locrian #6 (Mode 2)</option>
                        <option value="ionian_5">Ionian #5 (Mode 3)</option>
                        <option value="dorian_4">Dorian #4 (Mode 4)</option>
                        <option value="phrygian_dominant">Phrygian Dominant (Mode 5)</option>
                        <option value="lydian_2">Lydian #2 (Mode 6)</option>
                        <option value="super_locrian_bb7">Super Locrian bb7 (Mode 7)</option>
                    </optgroup>
                    <optgroup label="Melodic Minor Modes">
                        <option value="melodic_minor">Melodic Minor</option>
                        <option value="dorian_b2">Dorian b2</option>
                        <option value="lydian_augmented">Lydian Augmented</option>
                        <option value="lydian_dominant">Lydian Dominant</option>
                        <option value="mixolydian_b6">Mixolydian b6 (Aeolian Dominant)</option>
                        <option value="locrian_2">Locrian #2</option>
                        <option value="super_locrian">Super Locrian (Altered)</option>
                    </optgroup>
                </select>
            </div>

            <div class="control-group">
                <label for="display-mode">Show As</label>
                <select id="display-mode">
                    <option value="notes">Notes</option>
                    <option value="intervals">Intervals</option>
                </select>
            </div>



            <!-- Chord Select Removed -->

        </div>

        <div class="legend-container">
            <h3>Interval Legend</h3>
            <div class="legend-items">
                <div class="legend-item"><span class="badge int-R">R</span> Root</div>
                <div class="legend-item"><span class="badge int-m2">m2</span> Minor 2nd</div>
                <div class="legend-item"><span class="badge int-M2">M2</span> Major 2nd</div>
                <div class="legend-item"><span class="badge int-m3">m3</span> Minor 3rd</div>
                <div class="legend-item"><span class="badge int-M3">M3</span> Major 3rd</div>
                <div class="legend-item"><span class="badge int-P4">P4</span> Perfect 4th</div>
                <div class="legend-item"><span class="badge int-P5">P5</span> Perfect 5th</div>
                <div class="legend-item"><span class="badge int-m6">m6</span> Minor 6th</div>
                <div class="legend-item"><span class="badge int-M6">M6</span> Major 6th</div>
                <div class="legend-item"><span class="badge int-m7">m7</span> Minor 7th</div>
                <div class="legend-item"><span class="badge int-M7">M7</span> Major 7th</div>
            </div>
        </div>

        <div class="fretboard-container">
            <div id="fretboard">
                <!-- Fretboard generated by JS -->
            </div>
        </div>

        <div class="scale-info">
            <h2>Current Scale: <span id="current-scale-name"></span></h2>
            <h3 id="selected-chord-name" style="min-height: 1.5em; color: var(--accent-color);"></h3>
            <div id="scale-notes" class="notes-display"></div>
        </div>

        <div id="diatonic-chords" class="diatonic-section">
            <h3 class="section-title">Diatonic Chords (Triads & 7ths)</h3>
            <div class="diatonic-grid">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- Progression Explorer (Hidden by default, toggleable via new button) -->
        <section id="progression-builder" class="progression-container" style="display: none;">
            <div class="progression-header">
                <h2>Harmonic Explorer</h2>
                <div class="explorer-controls">
                    <button id="reset-progression" class="action-btn small">Reset Path üîÑ</button>
                    <button id="play-progression-btn" class="action-btn small">Play ‚ñ∂Ô∏è</button>
                </div>
            </div>

            <div class="legend-container harmonic-legend" style="margin: 0 0 1rem 0; padding: 0.5rem;">
                <div class="legend-items">
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">‚ÜôÔ∏è</span> Resolve</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">‚ÜóÔ∏è</span> Tension</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">‚û°Ô∏è</span> Subdom</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">‚è∫Ô∏è</span> Neutral</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">üîó</span> Relative</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">‚ö°</span> Deceptive</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">üîÑ</span> Sec. Dom</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">üåë</span> Borrowed</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">üé®</span> Subst</div>
                    <div class="legend-item"><span class="badge"
                            style="background:none; border:none; font-size:1.2em">üöÄ</span> Modulate</div>
                </div>
            </div>

            <div class="explorer-layout">
                <!-- Timeline (History) -->
                <div class="timeline-wrapper">
                    <div id="progression-timeline" class="progression-timeline">
                        <div class="timeline-start-msg">Select a chord from the Grid or Graph to begin...</div>
                    </div>
                </div>

                <!-- Graph Area -->
                <div id="progression-graph" class="progression-graph">
                    <!-- Dynamic Nodes will be injected here -->
                    <div class="graph-placeholder">Select a starting chord from the Diatonic Grid to activate the graph.
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Modules (Loaded sequentially for global namespace access) -->
    <script src="static/js/music-theory.js"></script>
    <script src="static/js/audio.js"></script>
    <script src="static/js/state.js"></script>
    <script src="static/js/ui.js"></script>
    <script src="static/js/app.js"></script>
</body>

</html>